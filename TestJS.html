<html>
<body>
<h3>Various tests below...</h3>
<p></p>
<canvas id="myCanvas" width="1250" height="800" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>
<p>&nbsp;</p>
Select the # of points to generate <select id="sel1"></select> <br>
<input type="button" value="Generate" onclick="javascript:loadPoints()" /> &nbsp;
<input type="button" value="Clear" id="clear" />
<script>

var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");

var width=c.getAttribute("width");
var height=c.getAttribute("height");
var minDimension = Math.min(width, height);

document.getElementById('clear').addEventListener('click', function() {
        ctx.clearRect(0, 0, c.width, c.height);
      }, false);
	  
// populate select box
var select=document.getElementById("sel1");
for(var i=10;i<=500;i++) {
     var option = document.createElement("option");
	 option.setAttribute("value", i);
	 if(i==50) option.setAttribute("selected", true);
	 option.innerHTML = i;
	 select.appendChild(option);
}	  
 

function randomColor() {
	var r1=Math.floor(Math.random()*255);
	var g1=Math.floor(Math.random()*255);
	var b1=Math.floor(Math.random()*255);
	return "rgb(" + r1 + "," + g1 + "," + b1 + ")";
}	  

function loadPoints() {
	
	var numPoints = select.value;
	
	var radius = Math.ceil(Math.sqrt(minDimension/numPoints));
	
	var x_sections = Math.ceil(Math.sqrt(numPoints));
    var y_sections = Math.floor(numPoints/x_sections);
	
	var x_width=width/x_sections;
	var y_width=height/y_sections;
	
	var nodes =0;
	
	var paintCircle = function(x,y,r) {
		ctx.beginPath();
		ctx.arc(x, y, r, 0, 2 * Math.PI);
		ctx.stroke();
		ctx.fillStyle=randomColor();
		ctx.fill();
	}
	
    var padding = 5;	
		
	outerloop:
	for(var x=1;x<=x_sections; x++) {
	   for(y=1;y<=y_sections; y++) {			
			
			var x_coord = x_width*(x-Math.random()*0.55);
			var y_coord = y_width*(y-Math.random()*0.65);
			var r=radius*2*Math.max(0.5,Math.random());					
			
			while(x_coord+r > width-padding) x_coord-=2*Math.random();
			while(y_coord+r > height-padding) y_coord-=2*Math.random();
			while(x_coord-r < padding) x_coord+=2*Math.random();
			while(y_coord-r < padding) y_coord+=2*Math.random();
			
			paintCircle(x_coord, y_coord, r);			
			
			if(++nodes == numPoints) break outerloop;
		}
	}
	
	while(nodes++ < numPoints) {
		var x_coord = Math.random()*width;
		var y_coord = Math.random()*height;
		
		while(x_coord+r > width-padding) x_coord-=2*Math.random();
		while(y_coord+r > height-padding) y_coord-=2*Math.random();
		while(x_coord-r < padding) x_coord+=2*Math.random();
		while(y_coord-r < padding) y_coord+=2*Math.random();
		
		var r=radius*2*Math.max(0.5,Math.random());
		
		paintCircle(x_coord, y_coord, r);		
	}
}

function runIter(n) {
    var runs=0;
	var t = setInterval(function(){
		loadPoints();
		if(++runs == n) clearInterval(t);
	}, 1500);
	
}

</script>
<script type="text/javascript" src="js-test.js" ></script>
</body>
</html>